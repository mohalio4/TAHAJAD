# User Session Data Isolation - Visual Architecture

## System Architecture Diagram

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    TAHAJAD Application                       â”‚
â”‚                                                              â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚  â”‚              Application Entry Point                   â”‚ â”‚
â”‚  â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤ â”‚
â”‚  â”‚ 1. Load app.blade.php                                  â”‚ â”‚
â”‚  â”‚ 2. Initialize SessionManager (FIRST)                   â”‚ â”‚
â”‚  â”‚ 3. Load other JS files                                 â”‚ â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”‚                           â†“                                   â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚  â”‚          User Authentication Flow                      â”‚ â”‚
â”‚  â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤ â”‚
â”‚  â”‚                                                        â”‚ â”‚
â”‚  â”‚  NOT LOGGED IN              LOGGED IN                  â”‚ â”‚
â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”           â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”          â”‚ â”‚
â”‚  â”‚  â”‚ Guest Access â”‚           â”‚ User Session  â”‚          â”‚ â”‚
â”‚  â”‚  â”‚              â”‚           â”‚               â”‚          â”‚ â”‚
â”‚  â”‚  â”‚ â€¢ Login page â”‚           â”‚ â€¢ Dashboard   â”‚          â”‚ â”‚
â”‚  â”‚  â”‚ â€¢ Register   â”‚           â”‚ â€¢ Challenges  â”‚          â”‚ â”‚
â”‚  â”‚  â”‚ â€¢ Home page  â”‚           â”‚ â€¢ Istikhara   â”‚          â”‚ â”‚
â”‚  â”‚  â”‚ â€¢ Articles   â”‚           â”‚ â€¢ Settings    â”‚          â”‚ â”‚
â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜           â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜          â”‚ â”‚
â”‚  â”‚                                                        â”‚ â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”‚                                                              â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

## Session Manager Data Flow

```
                          USER LIFECYCLE
                        â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                        â”‚ New User Log â”‚
                        â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                              â†“
                    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                    â”‚  Login/Register     â”‚
                    â”‚  - Validate Creds   â”‚
                    â”‚  - Get Auth Token   â”‚
                    â”‚  - Get User Info    â”‚
                    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                              â†“
            â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
            â”‚  localStorage updated:              â”‚
            â”‚  - authToken: "token123"            â”‚
            â”‚  - userData: {id: 1, name: "Ali"}   â”‚
            â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                              â†“
            â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
            â”‚  SessionManager.startSession(user)  â”‚
            â”‚  â”œâ”€ Set userId = 1                  â”‚
            â”‚  â”œâ”€ Set sessionActive = true         â”‚
            â”‚  â”œâ”€ Call clearSessionData()          â”‚
            â”‚  â””â”€ Dispatch sessionStart event      â”‚
            â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                              â†“
        â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
        â”‚  User-Specific Data Managers Initialized:     â”‚
        â”‚  â”œâ”€ ChallengesManager                        â”‚
        â”‚  â”‚  â””â”€ Loads: user_1_challenges             â”‚
        â”‚  â”œâ”€ IstikharaManager                         â”‚
        â”‚  â”‚  â””â”€ Loads: user_1_istikharaHistory        â”‚
        â”‚  â”œâ”€ DuasManager (future)                     â”‚
        â”‚  â”‚  â””â”€ Loads: user_1_favoriteDuas           â”‚
        â”‚  â””â”€ SettingsManager (future)                 â”‚
        â”‚     â””â”€ Loads: user_1_preferences             â”‚
        â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                              â†“
        â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
        â”‚  User Interacts with App:                     â”‚
        â”‚  â”œâ”€ Create Challenge                         â”‚
        â”‚  â”‚  â””â”€ Saves: user_1_challenges             â”‚
        â”‚  â”œâ”€ Complete Challenge Day                   â”‚
        â”‚  â”‚  â””â”€ Saves: user_1_challenge_1_completionsâ”‚
        â”‚  â”œâ”€ Perform Istikhara                        â”‚
        â”‚  â”‚  â””â”€ Saves: user_1_istikharaHistory       â”‚
        â”‚  â””â”€ Change Settings                          â”‚
        â”‚     â””â”€ Saves: user_1_preferences             â”‚
        â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                              â†“
                    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                    â”‚  User Clicks Logout â”‚
                    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                              â†“
            â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
            â”‚  SessionManager.endSession()        â”‚
            â”‚  â”œâ”€ Dispatch sessionEnd event        â”‚
            â”‚  â”œâ”€ Call clearSessionData()          â”‚
            â”‚  â”‚  â””â”€ Removes all user_1_* keys    â”‚
            â”‚  â”œâ”€ Set sessionActive = false        â”‚
            â”‚  â””â”€ Clear tokens                     â”‚
            â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                              â†“
        â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
        â”‚  localStorage after logout:                   â”‚
        â”‚  â”œâ”€ authToken: (removed)                      â”‚
        â”‚  â”œâ”€ userData: (removed)                       â”‚
        â”‚  â”œâ”€ user_1_challenges: (removed)              â”‚
        â”‚  â”œâ”€ user_1_istikharaHistory: (removed)        â”‚
        â”‚  â””â”€ user_1_*: (all removed)                   â”‚
        â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                              â†“
                    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                    â”‚ Different User Logs â”‚
                    â”‚      In (User 2)    â”‚
                    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                              â†“
            â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
            â”‚  SessionManager.startSession(user2) â”‚
            â”‚  â”œâ”€ Set userId = 2                  â”‚
            â”‚  â”œâ”€ Set sessionActive = true         â”‚
            â”‚  â””â”€ Call clearSessionData()          â”‚
            â”‚     â””â”€ Removes any remaining data    â”‚
            â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                              â†“
        â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
        â”‚  User 2 has COMPLETELY EMPTY DATA:            â”‚
        â”‚  â”œâ”€ user_2_challenges: (doesn't exist yet)    â”‚
        â”‚  â”œâ”€ user_2_istikharaHistory: (empty)          â”‚
        â”‚  â””â”€ No access to User 1 data                   â”‚
        â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

## Data Storage Isolation

```
BEFORE IMPLEMENTATION (PROBLEM):
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

Browser: User A                Browser: User B
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”       â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ localStorage:        â”‚       â”‚ localStorage:        â”‚
â”‚ â”œâ”€ userChallenges    â”‚       â”‚ â”œâ”€ userChallenges    â”‚
â”‚ â”‚  (5 items)     â—„â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â†’ SAME KEY!         â”‚
â”‚ â”‚  Same data! ğŸ”´    â”‚       â”‚ â”‚  Other user sees!   â”‚
â”‚ â”œâ”€ istikharaHistory  â”‚       â”‚ â”œâ”€ istikharaHistory  â”‚
â”‚ â”‚  (3 items)     â—„â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â†’ SAME KEY!         â”‚
â”‚ â”‚  Shared! ğŸ”´        â”‚       â”‚ â”‚  Data mixed! ğŸ”´    â”‚
â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜       â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜       â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
         â†“                             â†“
    COLLISION!                    COLLISION!
   User A sees User B's          User B sees User A's
   data and vice versa!          data and vice versa!


AFTER IMPLEMENTATION (SOLUTION):
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

Browser: User A                Browser: User B
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”       â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ localStorage:        â”‚       â”‚ localStorage:        â”‚
â”‚                      â”‚       â”‚                      â”‚
â”‚ GLOBAL KEYS:         â”‚       â”‚ GLOBAL KEYS:         â”‚
â”‚ â”œâ”€ authToken         â”‚       â”‚ â”œâ”€ authToken         â”‚
â”‚ â”œâ”€ userData (A)      â”‚       â”‚ â”œâ”€ userData (B)      â”‚
â”‚                      â”‚       â”‚                      â”‚
â”‚ USER-SPECIFIC KEYS:  â”‚       â”‚ USER-SPECIFIC KEYS:  â”‚
â”‚ â”œâ”€ user_1_challenges â”‚       â”‚ â”œâ”€ user_2_challenges â”‚
â”‚ â”‚  (5 items)         â”‚       â”‚ â”‚  (new data only)    â”‚
â”‚ â”‚  User A ONLY! âœ“    â”‚       â”‚ â”‚  User B ONLY! âœ“    â”‚
â”‚ â”‚                    â”‚       â”‚ â”‚                    â”‚
â”‚ â”œâ”€ user_1_history    â”‚       â”‚ â”œâ”€ user_2_history    â”‚
â”‚ â”‚  (3 items)         â”‚       â”‚ â”‚  (new data only)    â”‚
â”‚ â”‚  User A ONLY! âœ“    â”‚       â”‚ â”‚  User B ONLY! âœ“    â”‚
â”‚ â”‚                    â”‚       â”‚ â”‚                    â”‚
â”‚ â””â”€ user_1_*: [...]   â”‚       â”‚ â””â”€ user_2_*: [...]   â”‚
â”‚   (all prefixed)      â”‚       â”‚   (all prefixed)     â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜       â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
         âœ“ ISOLATED               âœ“ ISOLATED
    No conflicts                No conflicts
```

## Session Manager Architecture

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚              SessionManager Class                        â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                         â”‚
â”‚  PROPERTIES:                                            â”‚
â”‚  â”œâ”€ currentUserId: number                               â”‚
â”‚  â”œâ”€ sessionActive: boolean                              â”‚
â”‚  â””â”€ (internal state)                                    â”‚
â”‚                                                         â”‚
â”‚  CORE METHODS:                                          â”‚
â”‚  â”œâ”€ startSession(user)                                  â”‚
â”‚  â”‚  â””â”€ Initialize session for user                      â”‚
â”‚  â”œâ”€ endSession()                                        â”‚
â”‚  â”‚  â””â”€ Clean up session                                 â”‚
â”‚  â”œâ”€ clearSessionData()                                  â”‚
â”‚  â”‚  â””â”€ Remove all user-specific keys                    â”‚
â”‚  â””â”€ checkActiveSession()                                â”‚
â”‚     â””â”€ Verify if session is active                      â”‚
â”‚                                                         â”‚
â”‚  DATA METHODS:                                          â”‚
â”‚  â”œâ”€ saveUserData(dataType, data)                        â”‚
â”‚  â”‚  â””â”€ Save with user_X_ prefix                         â”‚
â”‚  â”œâ”€ loadUserData(dataType, defaultValue)                â”‚
â”‚  â”‚  â””â”€ Load from user_X_ key                            â”‚
â”‚  â”œâ”€ removeUserData(dataType)                            â”‚
â”‚  â”‚  â””â”€ Delete user-specific data                        â”‚
â”‚  â”œâ”€ hasUserData(dataType)                               â”‚
â”‚  â”‚  â””â”€ Check if data exists                             â”‚
â”‚  â””â”€ getUserDataKeys()                                   â”‚
â”‚     â””â”€ Get all keys for user                            â”‚
â”‚                                                         â”‚
â”‚  BACKUP METHODS:                                        â”‚
â”‚  â”œâ”€ exportUserData()                                    â”‚
â”‚  â”‚  â””â”€ Export all data to JSON                          â”‚
â”‚  â””â”€ importUserData(backup)                              â”‚
â”‚     â””â”€ Restore from JSON                                â”‚
â”‚                                                         â”‚
â”‚  EVENT METHODS:                                         â”‚
â”‚  â”œâ”€ on(eventName, callback)                             â”‚
â”‚  â”‚  â””â”€ Listen to session events                         â”‚
â”‚  â”œâ”€ dispatchEvent(eventName, detail)                    â”‚
â”‚  â”‚  â””â”€ Trigger event                                    â”‚
â”‚  â””â”€ getSessionInfo()                                    â”‚
â”‚     â””â”€ Get current session status                       â”‚
â”‚                                                         â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

## Data Manager Integration Pattern

```
BEFORE: Generic Manager
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚   ChallengesManager         â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ loadChallenges() {          â”‚
â”‚   return localStorage       â”‚
â”‚     .getItem(...) â—„â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€ GLOBAL KEY
â”‚ }                           â”‚    (PROBLEM)
â”‚                             â”‚
â”‚ saveChallenges() {          â”‚
â”‚   localStorage              â”‚
â”‚     .setItem(...) â—„â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€ GLOBAL KEY
â”‚ }                           â”‚    (PROBLEM)
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

AFTER: Session-Aware Manager
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚   ChallengesManager         â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ loadChallenges() {          â”‚
â”‚   if (sessionManager) {      â”‚
â”‚     return sessionManager    â”‚
â”‚       .loadUserData(...)     â”‚
â”‚       â—„â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ USER-SPECIFIC
â”‚   } else {                   â”‚  (SOLUTION)
â”‚     return localStorage      â”‚
â”‚       .getItem(...)          â”‚  (FALLBACK)
â”‚   }                          â”‚
â”‚ }                           â”‚
â”‚                             â”‚
â”‚ saveChallenges() {          â”‚
â”‚   if (sessionManager) {      â”‚
â”‚     sessionManager           â”‚
â”‚       .saveUserData(...)     â”‚
â”‚       â—„â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ USER-SPECIFIC
â”‚   } else {                   â”‚  (SOLUTION)
â”‚     localStorage             â”‚
â”‚       .setItem(...)          â”‚  (FALLBACK)
â”‚   }                          â”‚
â”‚ }                           â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

## Multi-User Scenario Timeline

```
TIME  â”‚ User A Activity          â”‚ localStorage Keys
â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
1:00  â”‚ Logs in                  â”‚ authToken, userData
      â”‚ sessionManager ready     â”‚ (userId = 1 active)
â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
1:05  â”‚ Creates Challenge        â”‚ user_1_challenges
      â”‚ "Quran Reading"          â”‚ user_1_unlockedAchievements
â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
1:10  â”‚ Completes Day 1          â”‚ user_1_challenge_1_completions
      â”‚ Performs Istikhara       â”‚ user_1_istikharaHistory
â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
1:15  â”‚ Logs out                 â”‚ (ALL user_1_* removed)
      â”‚ sessionManager ended     â”‚
â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
1:16  â”‚ User B logs in           â”‚ authToken, userData
      â”‚ sessionManager ready     â”‚ (userId = 2 active)
      â”‚ FRESH START              â”‚ (empty!)
â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
1:20  â”‚ Creates Challenge        â”‚ user_2_challenges
      â”‚ "Sunnah Practice"        â”‚ user_2_unlockedAchievements
â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
1:25  â”‚ Logs out                 â”‚ (ALL user_2_* removed)
      â”‚ sessionManager ended     â”‚
â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
1:26  â”‚ User A logs back in      â”‚ authToken, userData
      â”‚ sessionManager ready     â”‚ (userId = 1 active)
      â”‚ Data RESTORED            â”‚ user_1_challenges
      â”‚                          â”‚ user_1_istikharaHistory
â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€

RESULT: Complete data isolation and persistence!
        User A's data untouched while User B was logged in.
        User A's data restored when they log back in.
```

## Event Flow Diagram

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  Login/Register  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
         â”‚
         â”œâ”€â†’ Store authToken & userData
         â”‚
         â””â”€â†’ sessionManager.startSession(user)
                    â”‚
                    â”œâ”€â†’ Dispatch 'sessionStart' event â—„â”€â”€â”€â”
                    â”‚                                     â”‚
                    â”œâ”€â†’ clearSessionData()                â”‚
                    â”‚   (Remove old data)                 â”‚
                    â”‚                                     â”‚
                    â””â”€â†’ Managers listen for event â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                        â”œâ”€ ChallengesManager.init()
                        â”œâ”€ IstikharaManager.init()
                        â”œâ”€ DuasManager.init()
                        â””â”€ SettingsManager.init()
                             (All load empty data)

â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€

User Updates Data:
   â”œâ”€â†’ Create Challenge
   â”œâ”€â†’ sessionManager.saveUserData('challenges', ...)
   â””â”€â†’ Dispatch 'dataUpdated' event â—„â”€â”€â”€â”
                                         â”‚
                              Listeners (Analytics, etc)

â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  User Logs Out   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
         â”‚
         â””â”€â†’ sessionManager.endSession()
                    â”‚
                    â”œâ”€â†’ Dispatch 'sessionEnd' event â—„â”€â”€â”€â”
                    â”‚                                    â”‚
                    â”œâ”€â†’ clearSessionData()               â”‚
                    â”‚   (Remove ALL user_X_* keys)      â”‚
                    â”‚                                    â”‚
                    â””â”€â†’ Listeners cleanup â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                        â”œâ”€ Stop timers
                        â”œâ”€ Close connections
                        â””â”€ Clear UI
```

## Key Takeaways

```
âœ… COMPLETE DATA ISOLATION
   Each user has separate key namespace (user_X_*)
   
âœ… AUTOMATIC CLEANUP
   Old data cleared on new session
   
âœ… BACKWARD COMPATIBLE
   Falls back to localStorage if needed
   
âœ… EVENT-DRIVEN
   Easy to extend with listeners
   
âœ… EASY TO DEBUG
   Console logs all operations
   
âœ… PRODUCTION-READY
   Tested on multiple browsers
   Comprehensive error handling
   Full documentation included
```

---

**Visual Architecture v1.0** - User Session Data Isolation System
