    <main class="maktaba-page">
        <div class="maktaba-container">
            <!-- Header -->
            <header class="maktaba-header glass-card">
                <h1 class="maktaba-title">Ù…ÙƒØªØ¨Ø© Ù…Ø³Ù…ÙˆØ¹Ø©</h1>
                <p class="maktaba-subtitle">Ø¯Ù„ÙŠÙ„ Ø¥Ø¹Ø¯Ø§Ø¯ Ø®Ø¯Ù…Ø© Ù…ÙƒØªØ¨Ø© Ø§Ù„ØµÙˆØªÙŠØ§Øª Laravel</p>
                <p class="maktaba-description">Laravel Audio Library Service Setup Guide</p>
                <div class="maktaba-meta">
                    <span class="meta-item">ðŸ“š Ø¯Ù„ÙŠÙ„ ØªÙ‚Ù†ÙŠ</span>
                    <span class="meta-item">ðŸ”§ Laravel Backend</span>
                    <span class="meta-item">ðŸ“± Flutter Integration</span>
                </div>
            </header>
            
            <!-- Content Sections -->
            <div class="maktaba-content">
                
                <!-- Overview Section -->
                <section class="content-section glass-card">
                    <h2 class="section-title">Ù†Ø¸Ø±Ø© Ø¹Ø§Ù…Ø©</h2>
                    <div class="section-content">
                        <p>ÙŠØ´Ø±Ø­ Ù‡Ø°Ø§ Ø§Ù„Ø¯Ù„ÙŠÙ„ ÙƒÙŠÙÙŠØ© Ø¨Ù†Ø§Ø¡ Ø®Ø¯Ù…Ø© backend Ù„Ù…ÙƒØªØ¨Ø© Ø§Ù„ØµÙˆØªÙŠØ§Øª Ø¨Ø§Ø³ØªØ®Ø¯Ø§Ù… Laravel Ø§Ù„ØªÙŠ ØªØªÙƒØ§Ù…Ù„ Ù…Ø¹ ØªØ·Ø¨ÙŠÙ‚ Flutter Ø§Ù„Ù…Ø­Ù…ÙˆÙ„.</p>
                        <div class="info-box">
                            <h3>Ø§Ù„Ù…Ø¹Ù„ÙˆÙ…Ø§Øª Ø§Ù„Ø£Ø³Ø§Ø³ÙŠØ©:</h3>
                            <ul>
                                <li><strong>Base URL:</strong> <code>https://fancy-boat-e3b2.tahajjad-lb.workers.dev</code></li>
                                <li><strong>API Endpoint:</strong> <code>/api/catalog</code></li>
                            </ul>
                        </div>
                    </div>
                </section>
                
                <!-- API Requirements Section -->
                <section class="content-section glass-card">
                    <h2 class="section-title">Ù…ØªØ·Ù„Ø¨Ø§Øª API</h2>
                    <div class="section-content">
                        <h3>Endpoint: GET /api/catalog</h3>
                        <p><strong>Response Format:</strong> JSON array of audio items</p>
                        
                        <h4>Expected Response Structure:</h4>
                        <pre><code class="language-json">[
  {
    "id": "1",
    "title": "Audio Title",
    "speaker": "Speaker Name",
    "relation": "Relation/Context",
    "date": "2024-01-15",
    "audio": "/audio/example.m4a",
    "cover": "/images/cover.jpg",
    "durationSec": 3600,
    "type": "ad3eya"
  }
]</code></pre>
                        
                        <h4>Field Descriptions:</h4>
                        <div class="table-wrapper">
                            <table class="data-table">
                                <thead>
                                    <tr>
                                        <th>Field</th>
                                        <th>Type</th>
                                        <th>Required</th>
                                        <th>Description</th>
                                    </tr>
                                </thead>
                                <tbody>
                                    <tr><td><code>id</code></td><td>string</td><td>Yes</td><td>Unique identifier for the audio item</td></tr>
                                    <tr><td><code>title</code></td><td>string</td><td>Yes</td><td>Title of the audio</td></tr>
                                    <tr><td><code>speaker</code></td><td>string</td><td>Yes</td><td>Name of the speaker</td></tr>
                                    <tr><td><code>relation</code></td><td>string</td><td>Yes</td><td>Relation or context (e.g., "Ø²ÙŠØ§Ø±Ø©", "Ø¯Ø¹Ø§Ø¡")</td></tr>
                                    <tr><td><code>date</code></td><td>string</td><td>Yes</td><td>Date in format "YYYY-MM-DD"</td></tr>
                                    <tr><td><code>audio</code></td><td>string</td><td>Yes</td><td>Path to audio file (relative or absolute URL)</td></tr>
                                    <tr><td><code>cover</code></td><td>string</td><td>No</td><td>Path to cover image (optional)</td></tr>
                                    <tr><td><code>durationSec</code></td><td>integer</td><td>No</td><td>Duration in seconds (optional)</td></tr>
                                    <tr><td><code>type</code></td><td>string</td><td>Yes</td><td>Audio type category</td></tr>
                                </tbody>
                            </table>
                        </div>
                        
                        <h4>Audio Types:</h4>
                        <div class="types-grid">
                            <div class="type-card"><code>ad3eya</code> - Ø£Ø¯Ø¹ÙŠØ© ÙˆØ²ÙŠØ§Ø±Ø§Øª</div>
                            <div class="type-card"><code>majlis</code> - Ø¹Ø²Ø§Ø¡</div>
                            <div class="type-card"><code>aakida</code> - Ø¹Ù‚Ø§Ø¦Ø¯</div>
                            <div class="type-card"><code>sira</code> - Ø³ÙŠØ±Ø©</div>
                            <div class="type-card"><code>fokoh</code> - ÙÙ‚Ù‡</div>
                            <div class="type-card"><code>akhlak</code> - Ø£Ø®Ù„Ø§Ù‚</div>
                            <div class="type-card"><code>motnawe3</code> - Ù…ØªÙ†ÙˆÙ‘Ø¹</div>
                            <div class="type-card"><code>quran</code> - Ù‚Ø±Ø¢Ù†</div>
                            <div class="type-card"><code>snasrollah</code> - Ø§Ù„Ø´Ù‘Ù‡ÙŠØ¯ Ø§Ù„Ø³ÙŠØ¯ Ø­Ø³Ù† Ù†ØµØ±Ø§Ù„Ù„Ù‡</div>
                        </div>
                    </div>
                </section>
                
                <!-- Laravel Implementation Section -->
                <section class="content-section glass-card">
                    <h2 class="section-title">ØªÙ†ÙÙŠØ° Laravel</h2>
                    <div class="section-content">
                        
                        <!-- Database Schema -->
                        <div class="subsection">
                            <h3>1. Database Schema</h3>
                            <p>Create a migration for the audio items table:</p>
                            <pre><code class="language-php"><?php
// database/migrations/YYYY_MM_DD_create_audio_items_table.php

use Illuminate\Database\Migrations\Migration;
use Illuminate\Database\Schema\Blueprint;
use Illuminate\Support\Facades\Schema;

return new class extends Migration
{
    public function up(): void
    {
        Schema::create('audio_items', function (Blueprint $table) {
            $table->id();
            $table->string('title');
            $table->string('speaker');
            $table->string('relation');
            $table->date('date');
            $table->string('audio_path'); // Path to audio file
            $table->string('cover_path')->nullable(); // Path to cover image
            $table->integer('duration_sec')->nullable(); // Duration in seconds
            $table->string('type'); // Audio type category
            $table->timestamps();
            
            // Indexes for better query performance
            $table->index('type');
            $table->index('date');
            $table->index('speaker');
        });
    }

    public function down(): void
    {
        Schema::dropIfExists('audio_items');
    }
};</code></pre>
                        </div>
                        
                        <!-- Model -->
                        <div class="subsection">
                            <h3>2. Model</h3>
                            <p>Create the AudioItem model:</p>
                            <pre><code class="language-php"><?php
// app/Models/AudioItem.php

namespace App\Models;

use Illuminate\Database\Eloquent\Model;

class AudioItem extends Model
{
    protected $fillable = [
        'title',
        'speaker',
        'relation',
        'date',
        'audio_path',
        'cover_path',
        'duration_sec',
        'type',
    ];

    protected $casts = [
        'date' => 'date',
        'duration_sec' => 'integer',
    ];

    /**
     * Get the API representation of the audio item
     */
    public function toApiArray(): array
    {
        return [
            'id' => (string) $this->id,
            'title' => $this->title,
            'speaker' => $this->speaker,
            'relation' => $this->relation,
            'date' => $this->date->format('Y-m-d'),
            'audio' => $this->getAudioUrl(),
            'cover' => $this->getCoverUrl(),
            'durationSec' => $this->duration_sec,
            'type' => $this->type,
        ];
    }

    /**
     * Get full URL for audio file
     */
    private function getAudioUrl(): string
    {
        // If audio_path is already a full URL, return it
        if (filter_var($this->audio_path, FILTER_VALIDATE_URL)) {
            return $this->audio_path;
        }
        
        // Otherwise, construct URL from base URL
        $baseUrl = rtrim(config('app.audio_base_url', config('app.url')), '/');
        return $baseUrl . '/' . ltrim($this->audio_path, '/');
    }

    /**
     * Get full URL for cover image
     */
    private function getCoverUrl(): ?string
    {
        if (!$this->cover_path) {
            return null;
        }
        
        // If cover_path is already a full URL, return it
        if (filter_var($this->cover_path, FILTER_VALIDATE_URL)) {
            return $this->cover_path;
        }
        
        // Otherwise, construct URL from base URL
        $baseUrl = rtrim(config('app.audio_base_url', config('app.url')), '/');
        return $baseUrl . '/' . ltrim($this->cover_path, '/');
    }
}</code></pre>
                        </div>
                        
                        <!-- Controller -->
                        <div class="subsection">
                            <h3>3. Controller</h3>
                            <p>Create the AudioController:</p>
                            <pre><code class="language-php"><?php
// app/Http/Controllers/Api/AudioController.php

namespace App\Http\Controllers\Api;

use App\Http\Controllers\Controller;
use App\Models\AudioItem;
use Illuminate\Http\JsonResponse;

class AudioController extends Controller
{
    /**
     * Get all audio items catalog
     * 
     * @return JsonResponse
     */
    public function catalog(): JsonResponse
    {
        $items = AudioItem::orderBy('date', 'desc')
            ->orderBy('id', 'desc')
            ->get()
            ->map(fn($item) => $item->toApiArray());

        return response()->json($items);
    }
}</code></pre>
                        </div>
                        
                        <!-- Routes -->
                        <div class="subsection">
                            <h3>4. Routes</h3>
                            <p>Add the API route:</p>
                            <pre><code class="language-php"><?php
// routes/api.php

use App\Http\Controllers\Api\AudioController;
use Illuminate\Support\Facades\Route;

// Audio Library API
Route::get('/catalog', [AudioController::class, 'catalog'])->name('api.audio.catalog');</code></pre>
                        </div>
                        
                        <!-- Configuration -->
                        <div class="subsection">
                            <h3>5. Configuration</h3>
                            <p>Add audio base URL to your <code>.env</code> file:</p>
                            <pre><code class="language-bash">AUDIO_BASE_URL=https://your-domain.com</code></pre>
                            <p>Add to <code>config/app.php</code>:</p>
                            <pre><code class="language-php">'audio_base_url' => env('AUDIO_BASE_URL', env('APP_URL')),</code></pre>
                        </div>
                        
                        <!-- CORS Configuration -->
                        <div class="subsection">
                            <h3>6. CORS Configuration</h3>
                            <p>Ensure CORS is properly configured in <code>config/cors.php</code>:</p>
                            <pre><code class="language-php">'paths' => ['api/*'],
'allowed_methods' => ['*'],
'allowed_origins' => ['*'], // Or specify your Flutter app domains
'allowed_headers' => ['*'],</code></pre>
                        </div>
                    </div>
                </section>
                
                <!-- Authentication Section -->
                <section class="content-section glass-card">
                    <h2 class="section-title">Ø§Ù„Ù…ØµØ§Ø¯Ù‚Ø© (Ø§Ø®ØªÙŠØ§Ø±ÙŠ)</h2>
                    <div class="section-content">
                        <p>Ø¥Ø°Ø§ ÙƒÙ†Øª ØªØ­ØªØ§Ø¬ Ù„Ø­Ù…Ø§ÙŠØ© API Ø¨Ø§Ù„Ù…ØµØ§Ø¯Ù‚Ø©ØŒ ÙŠÙ…ÙƒÙ†Ùƒ Ø§Ø³ØªØ®Ø¯Ø§Ù… Laravel Sanctum Ø£Ùˆ API tokens:</p>
                        <pre><code class="language-php">Route::middleware('auth:sanctum')->get('/catalog', [AudioController::class, 'catalog']);</code></pre>
                        <p>The Flutter app would need to send the token in headers:</p>
                        <pre><code class="language-dart">final headers = {
  'Authorization': 'Bearer YOUR_API_TOKEN',
  'Accept': 'application/json',
};</code></pre>
                    </div>
                </section>
                
                <!-- Server Configuration Section -->
                <section class="content-section glass-card">
                    <h2 class="section-title">Ø¥Ø¹Ø¯Ø§Ø¯Ø§Øª Ø§Ù„Ø®Ø§Ø¯Ù…</h2>
                    <div class="section-content">
                        <div class="config-box">
                            <h4>API Base URL:</h4>
                            <code>https://your-laravel-domain.com/api</code>
                            
                            <h4>Full Catalog Endpoint:</h4>
                            <code>https://your-laravel-domain.com/api/catalog</code>
                            
                            <h4>Database Credentials:</h4>
                            <pre><code class="language-bash">DB_CONNECTION=mysql
DB_HOST=127.0.0.1
DB_PORT=3306
DB_DATABASE=your_database_name
DB_USERNAME=your_database_user
DB_PASSWORD=your_database_password</code></pre>
                        </div>
                    </div>
                </section>
                
                <!-- File Storage Section -->
                <section class="content-section glass-card">
                    <h2 class="section-title">ØªØ®Ø²ÙŠÙ† Ø§Ù„Ù…Ù„ÙØ§Øª</h2>
                    <div class="section-content">
                        <h4>Option 1: Local Storage</h4>
                        <p>Store files in <code>storage/app/public/audio/</code> and <code>storage/app/public/images/</code>:</p>
                        <pre><code class="language-bash">php artisan storage:link</code></pre>
                        
                        <h4>Option 2: Cloud Storage (S3, etc.)</h4>
                        <p>Configure filesystem in <code>config/filesystems.php</code>:</p>
                        <pre><code class="language-php">$audioPath = Storage::disk('s3')->url('audio/example.m4a');</code></pre>
                    </div>
                </section>
                
                <!-- Testing Section -->
                <section class="content-section glass-card">
                    <h2 class="section-title">Ø§Ø®ØªØ¨Ø§Ø± API</h2>
                    <div class="section-content">
                        <p>Test the endpoint using curl:</p>
                        <pre><code class="language-bash">curl -X GET https://your-laravel-domain.com/api/catalog \
  -H "Accept: application/json"</code></pre>
                        <p>Or using Postman/Insomnia:</p>
                        <ul>
                            <li>Method: GET</li>
                            <li>URL: <code>https://your-laravel-domain.com/api/catalog</code></li>
                            <li>Headers: <code>Accept: application/json</code></li>
                        </ul>
                    </div>
                </section>
                
                <!-- Additional Features Section -->
                <section class="content-section glass-card">
                    <h2 class="section-title">Ù…ÙŠØ²Ø§Øª Ø¥Ø¶Ø§ÙÙŠØ© (Ø§Ø®ØªÙŠØ§Ø±ÙŠ)</h2>
                    <div class="section-content">
                        <h4>1. Filtering and Search</h4>
                        <pre><code class="language-php">public function catalog(Request $request): JsonResponse
{
    $query = AudioItem::query();
    
    // Filter by type
    if ($request->has('type')) {
        $query->where('type', $request->type);
    }
    
    // Search in title and speaker
    if ($request->has('search')) {
        $search = $request->search;
        $query->where(function($q) use ($search) {
            $q->where('title', 'like', "%{$search}%")
              ->orWhere('speaker', 'like', "%{$search}%");
        });
    }
    
    $items = $query->orderBy('date', 'desc')->get()
        ->map(fn($item) => $item->toApiArray());

    return response()->json($items);
}</code></pre>
                        
                        <h4>2. Pagination</h4>
                        <pre><code class="language-php">public function catalog(Request $request): JsonResponse
{
    $perPage = $request->get('per_page', 50);
    $items = AudioItem::orderBy('date', 'desc')
        ->paginate($perPage)
        ->through(fn($item) => $item->toApiArray());

    return response()->json($items);
}</code></pre>
                        
                        <h4>3. Caching</h4>
                        <pre><code class="language-php">public function catalog(): JsonResponse
{
    $items = Cache::remember('audio_catalog', 3600, function () {
        return AudioItem::orderBy('date', 'desc')
            ->get()
            ->map(fn($item) => $item->toApiArray());
    });

    return response()->json($items);
}</code></pre>
                    </div>
                </section>
                
                <!-- Security Section -->
                <section class="content-section glass-card">
                    <h2 class="section-title">Ø§Ø¹ØªØ¨Ø§Ø±Ø§Øª Ø§Ù„Ø£Ù…Ø§Ù†</h2>
                    <div class="section-content">
                        <ul>
                            <li><strong>Rate Limiting:</strong> Add rate limiting to prevent abuse</li>
                            <li><strong>Input Validation:</strong> Validate any query parameters</li>
                            <li><strong>HTTPS:</strong> Always use HTTPS in production</li>
                            <li><strong>CORS:</strong> Configure CORS properly for production</li>
                        </ul>
                        <pre><code class="language-php">Route::middleware(['throttle:60,1'])->get('/catalog', [AudioController::class, 'catalog']);</code></pre>
                    </div>
                </section>
                
                <!-- Next Steps Section -->
                <section class="content-section glass-card">
                    <h2 class="section-title">Ø§Ù„Ø®Ø·ÙˆØ§Øª Ø§Ù„ØªØ§Ù„ÙŠØ©</h2>
                    <div class="section-content">
                        <ol class="steps-list">
                            <li>Set up your Laravel project</li>
                            <li>Run migrations to create the database table</li>
                            <li>Seed some test data</li>
                            <li>Configure file storage</li>
                            <li>Test the API endpoint</li>
                            <li>Update Flutter app with new base URL</li>
                            <li>Deploy to production server</li>
                        </ol>
                        <div class="warning-box">
                            <strong>âš ï¸ Ù…Ù„Ø§Ø­Ø¸Ø©:</strong> Ø§Ø³ØªØ¨Ø¯Ù„ Ø§Ù„Ù‚ÙŠÙ… Ø§Ù„Ù†Ø§Ø¦Ø¨Ø© (URLs, passwords, tokens) Ø¨Ø¨ÙŠØ§Ù†Ø§ØªÙƒ Ø§Ù„ÙØ¹Ù„ÙŠØ© Ù‚Ø¨Ù„ Ø§Ù„Ù†Ø´Ø± ÙÙŠ Ø§Ù„Ø¥Ù†ØªØ§Ø¬.
                        </div>
                    </div>
                </section>
                
            </div>
        </div>
    </main>
    
    <!-- Scripts -->
    <script src="../js/navigation.js"></script>
    <script src="../js/theme-switcher.js"></script>
